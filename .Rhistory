factorial1 <- haven::read_sav(file = "input/data/original/factorial_ola1.sav")
library(sjlabelled)
library(stringr)
library(stringi)
library(dplyr)
library(datasets)
library(data.table)
library(tidyr)
library(summarytools)
library(sjPlot)
library(stargazer)
library(knitr)
library(tidyverse)
library(mice)
library(texreg)
library(lme4)
load(file = "input/data/proc/vig_resp.RData")
factorial1 <- haven::read_sav(file = "input/data/original/factorial_ola1.sav")
library(sjlabelled)
library(stringr)
library(stringi)
library(dplyr)
library(datasets)
library(data.table)
library(tidyr)
library(summarytools)
library(sjPlot)
library(stargazer)
library(knitr)
library(tidyverse)
library(mice)
library(texreg)
library(lme4)
setwd("~/documentos-pcloud/factorial-impuestos")
load(file = "input/data/proc/vig_resp.RData")
factorial1 <- haven::read_sav(file = "input/data/original/factorial_ola1.sav")
factorial2 <- haven::read_sav(file = "input/data/original/factorial_ola2.sav")
sjmisc::frq(vig_resp$necesidades.vig)
perc1<- lmer(taxperc.ln~sexo.vig+factor(edad.vig)+factor(educ.vig)+factor(apellido.vig)+factor(nse_ori.vig)+factor(necesidades.vig)+factor(educ_madre.vig)+factor(ingresos.vig)+factor(educ.re)+(1 | respondeid),data = vig_resp)
just1<- lmer(taxjust.ln~sexo.vig+factor(edad.vig)+factor(educ.vig)+factor(apellido.vig)+factor(nse_ori.vig)+factor(necesidades.vig)+factor(educ_madre.vig)+factor(ingresos.vig)+factor(educ.re)+taxperc.ln+(1 | respondeid),data = vig_resp)
knitreg(list(perc1,just1))
save(factorial1,file = "input/data/proc/factorial_ola1.RData")
save(factorial2,file = "input/data/proc/factorial_ola2.RData")
load(file = "input/data/proc/factorial_ola1.RData")
save(file = "input/data/proc/factorial_ola2.RData")
load(file = "input/data/proc/factorial_ola1.RData")
load(file = "input/data/proc/factorial_ola2.RData")
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = TRUE,results = "hold")
knitr::opts_knit$set(root.dir = "../")
options(scipen=999)
rm(list=ls())
options(knitr.kable.NA = '')
Sys.setlocale("LC_MESSAGES", 'es_CL.UTF-8')
Sys.setenv(LANG = "es_CL.UTF-8")
load(file = "input/data/proc/factorial_ola1.RData")
load(file = "input/data/proc/factorial_ola2.RData")
load(file = "input/data/proc/factorial_ola2.RData")
load(file = "input/data/proc/factorial_ola1.RData")
load(file = "input/data/proc/factorial_ola2.RData")
factorial1 <- haven::read_sav(file = "input/data/original/factorial_ola1.sav")
factorial2 <- haven::read_sav(file = "input/data/original/factorial_ola2.sav")
save(factorial1,file = "input/data/proc/factorial_ola1.RData")
save(factorial2,file = "input/data/proc/factorial_ola2.RData")
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = TRUE,results = "hold")
knitr::opts_knit$set(root.dir = "../")
options(scipen=999)
rm(list=ls())
options(knitr.kable.NA = '')
Sys.setlocale("LC_MESSAGES", 'es_CL.UTF-8')
Sys.setenv(LANG = "es_CL.UTF-8")
load(file = "input/data/proc/factorial_ola1.RData")
load(file = "input/data/proc/factorial_ola2.RData")
data01 <- read_spss(path = "input/data/original/factorial_mod-v01_august.sav")
load(file = "input/data/proc/vig_dim.RData")
data01 <- data01 %>% filter(StartDate>min(data01$StartDate)) # remove cases out of fieldwork date
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_",   # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
for (i in deck_cod01) {
names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
}
decks01<- remove_label(decks01)
decks01
View(decks01)
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
data01 <- read_spss(path = "input/data/original/factorial_mod-v01_august.sav")
load(file = "input/data/proc/vig_dim.RData")
data01 <- data01 %>% filter(StartDate>min(data01$StartDate)) # remove cases out of fieldwork date
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
View(data01)
data01 <- read_spss(path = "input/data/original/factorial_mod-v01_august.sav")
load(file = "input/data/proc/vig_dim.RData")
data01 <- data01 %>% filter(StartDate>min(data01$StartDate)) # remove cases out of fieldwork date
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_", # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
View(decks01)
decks01$p_a_101
decks01
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# deck_cod01<- c("FL_431_DO_","FL_446_DO_","FL_467_DO_","FL_481_DO_","FL_494_DO_",
#                "FL_507_DO_","FL_520_DO_","FL_533_DO_","FL_546_DO_","FL_559_DO_")
#
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_", # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
for (i in deck_cod01) {
names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
}
decks01<- remove_label(decks01)
View(decks01)
# Chunk 2
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = TRUE,results = "hold")
knitr::opts_knit$set(root.dir = "../")
options(scipen=999)
rm(list=ls())
options(knitr.kable.NA = '')
Sys.setlocale("LC_MESSAGES", 'es_CL.UTF-8')
Sys.setenv(LANG = "es_CL.UTF-8")
# Chunk 3
colorize <- function(x, color) {
if (knitr::is_latex_output()) {
sprintf("\\textcolor{%s}{%s}", color, x)
} else if (knitr::is_html_output()) {
sprintf("<span style='color: %s;'>%s</span>", color,
x)
} else x
}
# Chunk 4
library(sjlabelled)
library(stringr)
library(stringi)
library(dplyr)
library(datasets)
library(data.table)
library(tidyr)
library(summarytools)
library(sjPlot)
library(stargazer)
library(knitr)
library(tidyverse)
library(mice)
library(texreg)
library(lme4)
library(sessioninfo)
# Chunk 5
data01 <- read_spss(path = "input/data/original/factorial_mod-v01_august.sav")
load(file = "input/data/proc/vig_dim.RData")
data01 <- data01 %>% filter(StartDate>min(data01$StartDate)) # remove cases out of fieldwork date
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_", # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
deck_cod01
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# deck_cod01<- c("FL_431_DO_","FL_446_DO_","FL_467_DO_","FL_481_DO_","FL_494_DO_",
#                "FL_507_DO_","FL_520_DO_","FL_533_DO_","FL_546_DO_","FL_559_DO_")
#
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_", # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
for (i in deck_cod01) {
names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
}
decks01<- remove_label(decks01)
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# deck_cod01<- c("FL_431_DO_","FL_446_DO_","FL_467_DO_","FL_481_DO_","FL_494_DO_",
#                "FL_507_DO_","FL_520_DO_","FL_533_DO_","FL_546_DO_","FL_559_DO_")
#
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_", # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
for (i in deck_cod01) {
names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
}
decks01<- remove_label(decks01)
tiempo<- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231)) %>%
select(Duration__in_seconds_) %>% summarise(tiempo=median(Duration__in_seconds_/60))
tiempo
nam01<- decks01 %>% select(starts_with("deck_vig")) %>% names()
nam01
decks02 <- data.frame(!(is.na(decks01[nam01])));decks02[decks02==FALSE] <- NA
decks02
decks03 <- bind_cols(select(decks01,-nam01),decks02)
decks03
w <- which(decks03=="TRUE",arr.ind=TRUE)
decks03[w] <- names(decks03)[w[,"col"]]
decks03
View(decks03)
wide <- setDT(decks03)
long01<- melt(wide,
id.vars = "ResponseId",
variable.name = "wave",
measure = patterns("^p_a_","^p_b_","deck_vig"),
value.name = c("taxperc","taxjust","deck_vig"));long01$wave <- NULL
long01 <- na.omit(long01)
long01$deck_vig  <- str_replace_all(long01$deck_vig,pattern = "deck_vig",replacement = "")
View(long01)
table(long01$deck_vig)
sjmisc::frq(long01$deck_vig)
load(file = "input/data/proc/factorial_ola1.RData")
load(file = "input/data/proc/factorial_ola2.RData")
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = TRUE,results = "hold")
knitr::opts_knit$set(root.dir = "../")
options(scipen=999)
rm(list=ls())
options(knitr.kable.NA = '')
Sys.setlocale("LC_MESSAGES", 'es_CL.UTF-8')
Sys.setenv(LANG = "es_CL.UTF-8")
load(file = "input/data/proc/factorial_ola1.RData")
names(factorial1)
factorial1$FL_4_DO_FL_522
View(factorial1)
factorial1$p_a_58
decks01<- factorial1 %>% select(starts_with("p_a_"),
starts_with("p_b_"),
starts_with("FL_"))
View(decks01)
decks01<- factorial1 %>% select(starts_with("FL_"))
View(decks01)
names(decks01)
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
data01 <- read_spss(path = "input/data/original/factorial_mod-v01_august.sav")
load(file = "input/data/proc/vig_dim.RData")
data01 <- data01 %>% filter(StartDate>min(data01$StartDate)) # remove cases out of fieldwork date
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
for (i in deck_cod01) {
names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
}
decks01<- remove_label(decks01)
# data01 <- data01 %>% filter(Finished==1,Progress==100,!is.na(Q5231))
data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# data01 <- data01 %>% filter(consen==1,!is.na(Q5231))
# deck_cod01<- c("FL_431_DO_","FL_446_DO_","FL_467_DO_","FL_481_DO_","FL_494_DO_",
#                "FL_507_DO_","FL_520_DO_","FL_533_DO_","FL_546_DO_","FL_559_DO_")
#
# decks01<- data01 %>% select(ResponseId,"finished"=Finished,
#                             starts_with("p_a_"),
#                             starts_with("p_b_"),
#                             matches(paste(deck_cod01, collapse="|")))
#
# for (i in deck_cod01) {
#   names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
# }
#
# decks01<- remove_label(decks01)
deck_cod01<- c("FL_191_DO_","FL_193_DO_", # deck01
"FL_176_DO_","FL_178_DO_", # deck02
"FL_161_DO_","FL_163_DO_", # deck03
"FL_146_DO_","FL_148_DO_", # deck04
"FL_131_DO_","FL_133_DO_", # deck05
"FL_116_DO_","FL_118_DO_", # deck06
"FL_101_DO_","FL_103_DO_", # deck07
"FL_86_DO_","FL_88_DO_",   # deck08
"FL_71_DO_","FL_73_DO_",   # deck09
"FL_56_DO_","FL_58_DO_")   # deck10
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
for (i in deck_cod01) {
names(decks01) <- names(decks01) %>% str_replace_all(pattern = i,replacement = "deck_vig")
}
decks01<- remove_label(decks01)
View(decks01)
decks01<- data01 %>% select(ResponseId,"finished"=Finished,
starts_with("p_a_"),
starts_with("p_b_"),
matches(paste(deck_cod01, collapse="|")))
View(decks01)
decks01
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = TRUE,results = "hold")
knitr::opts_knit$set(root.dir = "../")
options(scipen=999)
rm(list=ls())
options(knitr.kable.NA = '')
Sys.setlocale("LC_MESSAGES", 'es_CL.UTF-8')
Sys.setenv(LANG = "es_CL.UTF-8")
load(file = "input/data/proc/factorial_ola1.RData")
load(file = "input/data/proc/factorial_ola2.RData")
decks01<- factorial1 %>% select(starts_with("FL_"))
names(decks01)
xlsx::write.xlsx(decks01)
xlsx::write.xlsx(decks01,file = 'decks.xlxs')
xlsx::write.xlsx(decks01,file = 'decks.xlsx')
